<!DOCTYPE html>
<html lang="en">


<head>
<meta charset="utf-8">
<title>Soccer Viz</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script type="text/javascript" src="d3/d3.js"></script>
<script type="text/javascript" src="dist/metricsgraphics.js"></script>
<link rel="stylesheet" type="text/css" href="dist/metricsgraphics.css">
<style>
body {
font: 11px sans-serif;
}

.axis path,
.axis line {
fill: none;
stroke: #000;
	shape-rendering: crispEdges;
}

.dot {
stroke: #fff;
}


.tooltip {
position: absolute;
width: 200px;
height: 28px;
pointer-events: none;
}

</style>
<!--Set up area for both of the graphs -->


<body>
<!-- Selection for the Statistics Graph-->
<div style="display: table-cell; width: 120;">
<label for="xdropdownStat">X: </label><select id="xdropdownStat">
<option val="region">Goals Against</option>
<option val="category">Goals For</option>
<option val="region">Goal Differential</option>
<option val="category">Points</option>

</select>
</div>
<div style="display: table-cell; width: 150;">
<label for="ydropdownStat">Y: </label><select id="ydropdownStat">
<option val="sales">Revenue</option>
<option val="profit">Position</option>

</select>
</div>
<div style="display: table-cell; width: 150;">
<button id="updateStat" onclick="updateClickedStat()">Update</button>
</div>
</div>



<!--Selection for the Social media Graph -->
<div style="display: table-cell; width: 120;">
<label for="xdropdownSocial">X: </label><select id="xdropdownSocial">
<option val="region">Twitter Followers</option>
<option val="category">Facebook Followers</option>

</select>
</div>
<div style="display: table-cell; width: 150;">
<label for="ydropdownSocial">Y: </label><select id="ydropdownSocial">
<option val="sales">Revenue</option>
<option val="profit">Position</option>

</select>
</div>
<div style="display: table-cell; width: 150;">
<button id="updateSocial" onclick="updateClickedSocial()">Update</button>
</div>
</div>

<!-- Year Selector-->

<div style="display: table-cell; width: 120;">
<label for="yearDropDown">Year: </label><select id="yearDropDown">
<option val="region">2014</option>
<option val="category">2013</option>
<option val="region">2012</option>
<option val="category">2010</option>
<option val="region">2009</option>
<option val="category">2008</option>
<option val="region">2007</option>
<option val="category">2006</option>
<option val="category">2005</option>

</select>
<div style="display: table-cell; width: 120;">
<button id="updateYear" onclick="updateYear()">Update</button>
</div>

<script src="http://d3js.org/d3.v3.min.js"></script>

<!-- Setup Chart areas-->
<div style="width: 100%; display: table;">
    <div style="display: table-row">
        <div id= "statArea" style="width: 200px; display: table-cell;">  </div>
        <div id= "SocialArea" style="display: table-cell;"> </div>
    </div>
</div>

<script>

//set the margins for the canvas 
var margin = {top: 20, right: 20, bottom: 30, left: 40},
width = 970 - margin.left - margin.right,
height = 500 - margin.top - margin.bottom;

//Create the label and scale holders for the Stat and Social graph 
var year= "2014";
var	XLabelStat;
var YLabelStat;
var XScaleStat;
var YScaleStat;
var	XLabelSocial;
var YLabelSocial;
var XScaleSocial;
var YScaleSocial;
//can use these to access the data 
var twitterArr=[];
var facebookArr=[];
var revenueArr=[];
var positionArr=[];
var teamNames=[]
var countries=[];
var gfArr=[];
var gaArr=[];
var gdArr=[];
var pointsArr=[];



//Convert the umerical dat within our json 
function getSoccerData(year,data){

	for(i=0;i<data[year].length;i++){
		data[year][i].facebook=+ data[year][i].facebook;
		data[year][i].twitter=+ data[year][i].twitter;
		data[year][i].revenue=+data[year][i].revenue;
		data[year][i].position=+data[year][i].position;
		teamNames.push(data[year][i].name);
		countries.push(data[year][i].country);
		positionArr.push(data[year][i].position);
		twitterArr.push(data[year][i].twitter);
		revenueArr.push(data[year][i].revenue);
		facebookArr.push(data[year][i].facebook);
		gfArr.push(data[year][i]["stats"].gf);
		gaArr.push(data[year][i]["stats"].ga);
		gdArr.push(data[year][i]["stats"].gd);
		pointsArr.push(data[year][i]["stats"].points);
		}
		
	}

// Markers for Timeline graph.
var markers = [
		{'year':2006, 'label': 'World Cup'},
		{'year':2010, 'label': 'World Cup'},
		{'year':2014, 'label': 'World Cup'}
];

// Store timeline JSON locally after call to D3.json
var timelineData = {};

d3.json("TeamPositions.json", function(data){
	timelineData = data;

	// Timeline Container to hold timeline and legend.
	d3.select("body").append("div").attr('id','timelineContainter')
		// Timeline graph
		.append('div').attr("id", "timeline")
		.attr("style", "width:500px;float:left;");

	// Timeline legend
	d3.select('#timelineContainter').append('div')
		.attr('id', 'timelineLegend').attr('style','float:left;margin-top:4%');
	
	// Timeline Example Button 1 
	d3.select('body').append('div').attr('id','timelineButtons')
		.append('input')
		.attr('type', 'button')
		.attr('name', 'chelseaButton')
		.attr('value', 'Chelsea')
		.on('click', function() {
			updateTimeline(['Chelsea']);
		});
	// Timeline Example Button 2
	d3.select('#timelineButtons')
		.append('input')
		.attr('type', 'button')
		.attr('name', 'madridButton')
		.attr('value', 'Real Madrid')
		.on('click', function() {
			updateTimeline(['Chelsea',
							'Real Madrid'
							]);
		});
	// Timeline Example Button 3
	d3.select('#timelineButtons').append('input')
		.attr('type', 'button')
		.attr('name', 'romaButton')
		.attr('value', 'AS Roma')
		.on('click', function() {
			updateTimeline(['Chelsea',
							'Real Madrid',
							'AS Roma'
							]);
		});
	
	MG.data_graphic({
	    title: 'League Positions Over Time',
	    description: 'This is where a teams position over time will appear.',
	    data: data["Chelsea"], 
	    markers: markers,
	    width: 400,
	    height: 250,
	    interpolate: 'basic',
	    target: '#timeline', // the html element that the graphic is inserted in
	    x_accessor: 'year',  // the key that accesses the x value
	    y_accessor: 'position', // the key that accesses the y value
	    legend: ['Chelsea'],
	    legend_target: '#timelineLegend'
	});
});

/**
 * Graphs a timeline (position vs. time) given an array of team names.
 * @param {Array} team An array containing team names.
 */
function updateTimeline(teams) {
	console.log(teams);
	var data = [];
	for (var i = 0; i < teams.length; i++) {
		data.push(timelineData[teams[i]]);
	};
	
	MG.data_graphic({
	    title: 'League Positions Over Time',
	    description: 'This is where a teams position over time will appear.',
	    data: data, 
	    markers: markers,
	    width: 400,
	    height: 250,
	    interpolate: 'basic',
	    target: '#timeline', // the html element that the graphic is inserted in
	    x_accessor: 'year',  // the key that accesses the x value
	    y_accessor: 'position', // the key that accesses the y value
	    legend: teams,
	    legend_target: '#timelineLegend'
	});
}


//Set the variables to determine if the stats and social media graph have been drawn
var alreadyDrawnStats = false;
var alreadyDrawSocial= false;

// setup fill color
var cValueSocial = function(d) { return d.name;},
color = d3.scale.category20();
var cValueStat = function(d) { return d.name;},
color = d3.scale.category20();

//connect the svg elements to both the stat chart and the social revenue chart 
var statChart = d3.select("#statArea").append("svg")
.attr("width", (width + margin.left + margin.right)/1.225)
.attr("height", height + margin.top + margin.bottom)
.append("g")
.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var socialChart = d3.select("#socialArea").append("svg")
.attr("width", width + margin.left + margin.right)
.attr("height", height + margin.top + margin.bottom)
.append("g")
.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

//add the tool tip which we will use for the hoover effect for both charts 
var tooltip = d3.select("body").append("div")
.attr("class", "tooltip")
.style("opacity", 0);

// Returns the selected option in the X-axis dropdown for the stat chart. 
function getXSelectedOptionStat(){
	var node = d3.select('#xdropdownStat').node();
	var i = node.selectedIndex;
	return node[i].value;
}

// Returns the selected option in the Y-axis dropdown for the stat chart . 
function getYSelectedOptionStat(){
	var node = d3.select('#ydropdownStat').node();
	var i = node.selectedIndex;
	return node[i].value;
}	

// Returns the selected option in the X-axis dropdown for the social chart. 
function getXSelectedOptionSocial(){
	var node = d3.select('#xdropdownSocial').node();
	var i = node.selectedIndex;
	return node[i].value;
}

// Returns the selected option in the Y-axis dropdown for the social chart . 
function getYSelectedOptionSocial(){
	var node = d3.select('#ydropdownSocial').node();
	var i = node.selectedIndex;
	return node[i].value;
}	

// Returns the selected option in the dropdown for the year. 
function getYear(){
	var node = d3.select('#yearDropDown').node();
	var i = node.selectedIndex;
	return node[i].value;
}	
function updateYear(){
year= getYear();
console.log(year);
}

/* create the x- axis and y-axis for the stat chart and 
 * upload the information ONCE WE HAVE TIME ASSOCIATED WE WILL NEED TO ADJUST DATA INPUT
 */
function updateClickedStat(){

	if(getXSelectedOptionStat()=='Goals Against' && getYSelectedOptionStat()=='Revenue'){
		XLabelStat ="Goals Against";
		YLabelStat= "Revenue";
	}else if(getXSelectedOptionStat()=='Goals For' && getYSelectedOptionStat()=='Revenue'){
		XLabelStat ="Goals For";
		YLabelStat= "Revenue";
	}else if(getXSelectedOptionStat()=='Goal Differential' && getYSelectedOptionStat()=='Revenue'){
		XLabelStat ="Goal Differential";
		YLabelStat= "Revenue";
	}else if(getXSelectedOptionStat()=='Points' && getYSelectedOptionStat()=='Revenue'){
		XLabelStat ="Points";
		YLabelStat= "Revenue";
	}else if(getXSelectedOptionStat()=='Goals For' && getYSelectedOptionStat()=='Position'){
		XLabelStat ="Goals For";
		YLabelStat= "Position";
	}else if(getXSelectedOptionStat()=='Goal Differential' && getYSelectedOptionStat()=='Position'){
		XLabelStat="Goal Differential";
		YLabelStat= "Position";
	}else if(getXSelectedOptionStat()=='Goals Against' && getYSelectedOptionStat()=='Position'){
		XLabelStat ="Goals Against";
		YLabelStat= "Position";
	}else if(getXSelectedOptionStat()=='Points' && getYSelectedOptionStat()=='Position'){
		XLabelStat ="Points";
		YLabelStat= "Position";
	}
	
d3.json("SoccerData.json", function(error, data) {
	//console.log(data["2014"]);
		

	});
	
}

/* create the x- axis and y-axis for the social chart and 
 * upload the information ONCE WE HAVE TIME ASSOCIATED WE WILL NEED TO ADJUST DATA INPUT
 */
function updateClickedSocial(){

		
	if(getXSelectedOptionSocial()=='Twitter Followers' && getYSelectedOptionSocial()=='Revenue'){
		XLabelSocial ="twitter";
		YLabelSocial= "revenue";
		
		
	}else if(getXSelectedOptionSocial()=='Twitter Followers' && getYSelectedOptionSocial()=='Position'){
		XLabelSocial ="twitter";
		YLabelSocial= "position";
		
		
	}else if(getXSelectedOptionSocial()=='Facebook Followers' && getYSelectedOptionSocial()=='Revenue'){
		XLabelSocial ="facebook";
		YLabelSocial= "revenue";
	
		
	}else{
		XLabelSocial ="facebook";
		YLabelSocial= "position";
		
		
	}
	
		d3.json("SoccerData.json", function(error, data) {
	
		getSoccerData(year,data);
		console.log(gaArr);
		console.log(pointsArr);
		//drawSocial(XLabelSocial, YLabelSocial);

	});
}

</script>
</body>
</html>